Introduction
============

This is my final assignment for Exploiting and Securing Vulnerabilities
in Java Applications by University of California, Davis.

Try It! Reflected XSS
=====================

Questions and Answers
---------------------

### What is XSS and how does it work?

1.  Cross Site Scripting, otherwise knows as XSS is a code injection
    attack allowing the injection of malicious code into a website.

2.  XSS is currently one of the most common website attacks, with almost
    every website requiring the user to have JavaScript turned on.

3.  Rather than being an attack on the website itself, it uses the
    website as a means to attack the users of that website.

4.  When you can get your XSS permanetly on a website all those who
    visit that page will have the JavaScript executed by their browser.

### Why is it important to prevent XSS attacks? Which of the Confidentiality, Integrity, and Availability (CIA) triad does XSS compromise?

When you can get your XSS permanetly on a website all those who visit
that page will have the JavaScript executed by their browser.\
\
**Confidentiality** refers to limiting information access and disclosure
to authorized users and preventing access by or disclosure to
unauthorized ones

A screenshot highlighting the vulnerable field
----------------------------------------------

![image](xss_reflected/reflected_xss_vulnerability.png)\

Code/payload that can be inserted into the flawed field shown
-------------------------------------------------------------

![image](xss_reflected/reflected_xss_code.png)\

Patch
-----

![image](xss_reflected/reflected_xss_patch.png)\

Summary
-------

First of all , I found the XSS vulnerability by adding a javascript in
the credit card number field. The script had the most simple format,
therefore I conjectured that the field didn’t have any kind of encoding.
Patch was to put encoding at old variable and print the new one.\
$final String newVariable$ =
$org.owasp.encoder.Encode.forHtml(oldVariable)$.\
This way is going to prevent our code from XSS vulnerability.

Cross Site Scripting (stored)
=============================

A screenshot highlighting the vulnerable field
----------------------------------------------

![image](xss_stored/xss_stored_vulnerability.png)\

Code/payload that can be inserted into the flawed field shown
-------------------------------------------------------------

### Console Step 1

![image](xss_stored/xss_attack_1.png)\

### Step 2

![image](xss_stored/xss_attack_2.png)\

### Step 3

![image](xss_stored/xss_attack_3.png)\

### Step 4

![image](xss_stored/xss_attack_4.png)\

### Step 5

![image](xss_stored/xss_after.png)\

### XSS Attack

![image](xss_stored/xss_stored_code.png)\

### Result of XSS Attack

![image](xss_stored/xss_stored_code_2.png)\

Patch
-----

![image](xss_stored/xss_stored_patch.png)\

### After Patch

![image](xss_stored/xss_stored_patch_3.png)\

Summary
-------

By reading the instructions you can find the javascript command that you
have to run. The second part is to open the console from browser (e.g
Firefox) and execute the command that you have found above. By calling
the constructor you are going to dig out the secured information. For
the XSS attack , I just put a script after my comment, and vulnerability
has been exploited. I set the input variable to be only a text and I
encoded it with owasp.encoder. I put the result in a Map which has
$<String,Object>$ and finally I fixed the old variable with the new one,
by using the function writeValueAsString.

Try It! String SQL Injection
============================

Questions and Answers
---------------------

### What are Injection Attacks and how does it work?

1.  SQL injection is a code injection technique that might destroy your
    database.

2.  SQL injection is one of the most common web hacking techniques.

3.  SQL injection is the placement of malicious code in SQL statements,
    via web page input.

### Why is it important to prevent Injection Attacks?

SQL injection usually occurs when you ask a user for input, like their
username/userid, and instead of a name/id, the user gives you an SQL
statement that you will unknowingly run on your database. This SQL
statement might steal secured information, modify/destroy your database
etc.\
\

A screenshot highlighting the vulnerable field
----------------------------------------------

![image](sqli/sql_injection_pre_patch.png)\

Code/payload that can be inserted into the flawed field shown
-------------------------------------------------------------

### Sql Injection Attack

![image](sqli/sql_injection_pre.png)\

Patch
-----

![image](sqli/sql_injection_patch.png)\

### After Patch

![image](sqli/sql_injection_after.png)\

Summary
-------

The sql injection attack was a quite simple case of sqli and I patched
it by using prepared Statement and by setting input variable to be only
a string.

XXE
===

A screenshot highlighting the vulnerable field
----------------------------------------------

![image](xxe/Burp_vulnerability.png)\

Code/payload that can be inserted into the flawed field shown
-------------------------------------------------------------

### Burp Step 1

![image](xxe/Burp_proxy.png)\

### Step 2

![image](xxe/Burp_repeater_1.png)\

### XXE Attack

![image](xxe/burp_attack_1.png)\

Patch
-----

![image](xxe/xxe_patch.png)\

### After Patch

![image](xxe/burp_after_xxe.png)\

Summary
-------

By using Burp Suit you can read the traffic between client and server.
If you follow the pictures above , by setting correctly the browser and
burp suit you are going to find the xxe vulnerability. To prevent from
XXE you have to follow my code from above. This works for xml files as
you have already seen from above. Meanwhile if you want to do the same
in a json file you have to modify from burp suit the json file to xml,
to bypass the json security. The code remains the same.

Authentication Bypasses
=======================

Questions and Answers
---------------------

### What is Authentication Bypass how does it work??

Authentication Bypass is a result of improper or no authentication
mechanism implemented for application resources. Unauthenticated access
to dynamic content could result from improper access control and session
management or improper input validation (SQL Injection).

### Why is it important to prevent Authetn?

1.  They prevent a user from accessing an account that isn’t theirs.

2.  They restrict free accounts from getting premium features.

3.  They ensure internal accounts only have access to what they need.

\
\

A screenshot highlighting the vulnerable field
----------------------------------------------

![image](auth/auth_vulnerability.png)\

Code/payload that can be inserted into the flawed field shown
-------------------------------------------------------------

### Burp Suit

![image](auth/auth_pre.png)\

### Attack

![image](auth/auth_attack.png)\

### Pitchfork Attack, Numbers/Brute Force

![image](auth/intruder_1.png)\

![image](auth/intruder_attack_bruteforce.png)\

Patch
-----

![image](auth/auth_patch.png)\
\
\

### After Patch

![image](auth/auth_after.png)\

Summary
-------

By using Burp Suit you are able to exploit Authentication Bypass. First
of all you have to submit something and observe the result of that post
request in repeater. Meanwhile you should try to modify the result, by
changing the 0 and 1 of secQuestion. As you can see there is a hidden
vulnerability which is going to gives you the permission to change
user’s password. Also you can move to intruder tab to prepare a
pitchfork attack, by setting 1 and 3 payloads to Numbers type and 2,4 to
Brute Force type. After setting up these you can observe the result.

JWT Tokens
==========

A screenshot highlighting the vulnerable field
----------------------------------------------

![image](jwk/jwk_vulnerability.png)\

Code/payload that can be inserted into the flawed field shown
-------------------------------------------------------------

### Guest

![image](jwk/jtw_guest.png)\

### Jerry

![image](jwk/jwk_Jerry.png)\

### Sylvester

![image](jwk/jwk_sylvester.png)\

### JWT Attack

![image](jwk/jwk_repeater.png)\

### CyberChef

![image](jwk/cyberchef.png)\
\
\

![image](jwk/cyberchef2.png)\

Patch
-----

![image](jwk/jwk_patch.png)\

### After Patch

![image](jwk/jwk_patch_2.png)\

![image](jwk/jwk_Tom.png)\

Summary
-------

By using Burp Suit and CyberChef you are going to exploit the
vulnerability. First of all, send the post request to the receiver tab,
and take the json token and decode it (base64). After that you have to
create your new header and payload. The signature tou are going to leave
it blank. (Header.payload.signature). The payload is going to have the
user that you want with a true in admin field. Also you have to change
the code as you can see from above, by setting the user that you want as
admin(true) and rest people with false(function: login). After that to
reset Votes by admin you must change the resetVotes function.

Vulnerable Components
=====================

Questions and Answers
---------------------

### Why are Vulnerable Components important to the security of our application?

This kind of threat occurs when the components such as libraries and
frameworks used within the app almost always execute with full
privileges. If a vulnerable component is exploited, it makes the
hacker’s job easier to cause a serious data loss or server takeover.
